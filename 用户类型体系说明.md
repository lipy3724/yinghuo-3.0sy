# è¤ç«AIç”¨æˆ·ç±»å‹ä½“ç³»è¯´æ˜

## ğŸ“‹ æ¦‚è¿°

è¤ç«AIå¹³å°é‡‡ç”¨å››ç§ç”¨æˆ·ç±»å‹ä½“ç³»ï¼Œé€šè¿‡æ•°æ®åº“å­—æ®µç»„åˆæ¥å®ç°ç²¾ç»†çš„æƒé™æ§åˆ¶å’ŒèŒè´£åˆ†å·¥ã€‚

## ğŸ‘¥ ç”¨æˆ·ç±»å‹è¯¦è§£

### 1. æ™®é€šç”¨æˆ· (Regular User)
**æ•°æ®åº“æ ‡è¯†**:
```javascript
{
  isAdmin: false,
  isInternal: false, 
  isCustomerService: false
}
```

**æƒé™å’ŒåŠŸèƒ½**:
- âœ… ä½¿ç”¨æ‰€æœ‰AIåŠŸèƒ½ï¼ˆå›¾åƒå¤„ç†ã€è§†é¢‘ç¼–è¾‘ã€äºšé©¬é€ŠåŠ©æ‰‹ï¼‰
- âœ… ç§¯åˆ†æ¶ˆè´¹å’Œå……å€¼
- âœ… å‘èµ·å®¢æœå’¨è¯¢
- âœ… æŸ¥çœ‹ä¸ªäººä½¿ç”¨è®°å½•å’Œä¸‹è½½ä¸­å¿ƒ
- âŒ æ— ç®¡ç†åå°è®¿é—®æƒé™
- âŒ æ— å®¢æœç³»ç»Ÿè®¿é—®æƒé™

**ä¸šåŠ¡åœºæ™¯**: å¹³å°çš„ä¸»è¦ç”¨æˆ·ç¾¤ä½“ï¼Œé€šè¿‡ç§¯åˆ†è´­ä¹°å’Œæ¶ˆè´¹AIæœåŠ¡

### 2. å†…éƒ¨ç”¨æˆ· (Internal User)
**æ•°æ®åº“æ ‡è¯†**:
```javascript
{
  isAdmin: false,
  isInternal: true,
  isCustomerService: false
}
```

**æƒé™å’ŒåŠŸèƒ½**:
- âœ… å…¬å¸å†…éƒ¨å‘˜å·¥ç‰¹æ®Šæƒé™ï¼ˆå¯æ ¹æ®éœ€è¦æ‰©å±•ï¼‰
- âœ… ä½¿ç”¨AIåŠŸèƒ½ï¼ˆå¯èƒ½æœ‰ç‰¹æ®Šä¼˜æƒ æˆ–å…è´¹é¢åº¦ï¼‰
- âŒ ä¸å‚ä¸å®¢æœå·¥ä½œ
- âŒ æ— ç®¡ç†åå°è®¿é—®æƒé™
- âŒ æ— å®¢æœç³»ç»Ÿè®¿é—®æƒé™

**ä¸šåŠ¡åœºæ™¯**: å…¬å¸å†…éƒ¨å‘˜å·¥ï¼Œå¯èƒ½ç”¨äºæµ‹è¯•ã€æ¼”ç¤ºæˆ–å†…éƒ¨ä½¿ç”¨

### 3. å®¢æœ (Customer Service)
**æ•°æ®åº“æ ‡è¯†**:
```javascript
{
  isAdmin: false,
  isInternal: false,
  isCustomerService: true
}
```

**æƒé™å’ŒåŠŸèƒ½**:
- âœ… è®¿é—®å®¢æœç®¡ç†åå° (`/adminkefu.html`)
- âœ… å¤„ç†åˆ†é…ç»™è‡ªå·±çš„ç”¨æˆ·å’¨è¯¢
- âœ… æŸ¥çœ‹ç”¨æˆ·å¯¹è¯å†å²
- âœ… å‘é€å›å¤æ¶ˆæ¯
- âœ… æŸ¥çœ‹åˆ†é…çŠ¶æ€å’Œç»Ÿè®¡ä¿¡æ¯
- âŒ æ— å®Œæ•´ç®¡ç†åå°è®¿é—®æƒé™
- âŒ æ— ç”¨æˆ·ç®¡ç†æƒé™
- âŒ æ— ç³»ç»Ÿé…ç½®æƒé™

**ä¸šåŠ¡åœºæ™¯**: ä¸“é—¨çš„å®¢æœäººå‘˜ï¼Œä¸“æ³¨äºç”¨æˆ·æœåŠ¡å’Œé—®é¢˜è§£å†³

### 4. ç®¡ç†å‘˜ (Admin)
**æ•°æ®åº“æ ‡è¯†**:
```javascript
{
  isAdmin: true,
  // isInternal å’Œ isCustomerService å¯ä»¥ä¸ºä»»æ„å€¼
}
```

**æƒé™å’ŒåŠŸèƒ½**:
- âœ… è®¿é—®æ‰€æœ‰ç®¡ç†åå°
- âœ… ç”¨æˆ·ç®¡ç†ï¼ˆåˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤ã€å°ç¦ï¼‰
- âœ… ç³»ç»Ÿé…ç½®å’Œæ•°æ®ç»Ÿè®¡
- âœ… å®¢æœç³»ç»Ÿç®¡ç†æƒé™
- âœ… æ”¯ä»˜è®¢å•ç®¡ç†
- âœ… åŠŸèƒ½ä½¿ç”¨è®°å½•ç®¡ç†
- âœ… å®Œæ•´çš„ç³»ç»Ÿæ§åˆ¶æƒé™

**ä¸šåŠ¡åœºæ™¯**: ç³»ç»Ÿç®¡ç†å‘˜ï¼Œè´Ÿè´£å¹³å°çš„æ•´ä½“è¿è¥å’Œç®¡ç†

## ğŸ” æƒé™æ§åˆ¶é€»è¾‘

### å®¢æœç³»ç»Ÿè®¿é—®æƒé™
```javascript
// æ£€æŸ¥æ˜¯å¦å¯ä»¥è®¿é—®å®¢æœç³»ç»Ÿ
function canAccessCustomerService(user) {
  return user.isAdmin || user.isCustomerService;
}
```

### ç®¡ç†åå°è®¿é—®æƒé™
```javascript  
// æ£€æŸ¥æ˜¯å¦å¯ä»¥è®¿é—®ç®¡ç†åå°
function canAccessAdmin(user) {
  return user.isAdmin;
}
```

### å®¢æœåˆ†é…é€»è¾‘
```javascript
// è·å–å¯è¢«åˆ†é…çš„å®¢æœ
async function getAvailableCustomerService() {
  return await User.findAll({
    where: {
      isCustomerService: true  // åªæœ‰å®¢æœç±»å‹ç”¨æˆ·å¯è¢«åˆ†é…
    }
  });
}
```

## ğŸ¯ ç”¨æˆ·ç±»å‹åˆ¤æ–­æ–¹æ³•

### æ•°æ®åº“æ¨¡å‹æ–¹æ³•
```javascript
// Useræ¨¡å‹å®ä¾‹æ–¹æ³•
User.prototype.getUserType = function() {
  if (this.isAdmin) {
    return 'admin';
  } else if (this.isInternal) {
    return 'internal';
  } else if (this.isCustomerService) {
    return 'customer_service';
  } else {
    return 'regular';
  }
};

User.prototype.getUserTypeName = function() {
  const type = this.getUserType();
  const typeNames = {
    'admin': 'ç®¡ç†å‘˜',
    'internal': 'å†…éƒ¨ç”¨æˆ·', 
    'customer_service': 'å®¢æœ',
    'regular': 'æ™®é€šç”¨æˆ·'
  };
  return typeNames[type] || 'æœªçŸ¥ç±»å‹';
};
```

### æƒé™æ£€æŸ¥æ–¹æ³•
```javascript
// æ£€æŸ¥æ˜¯å¦å¯ä»¥è®¿é—®å®¢æœç³»ç»Ÿ
User.prototype.canAccessCustomerService = function() {
  return this.isAdmin || this.isCustomerService;
};

// æ£€æŸ¥æ˜¯å¦å¯ä»¥è®¿é—®ç®¡ç†åå°
User.prototype.canAccessAdmin = function() {
  return this.isAdmin;
};

// æ£€æŸ¥æ˜¯å¦å¯ä»¥è¢«åˆ†é…ä¸ºå®¢æœ
User.prototype.canBeAssignedAsCustomerService = function() {
  return this.isCustomerService;
};
```

## ğŸ”„ ç”¨æˆ·ç±»å‹è½¬æ¢

### åœ¨ç®¡ç†åå°ä¸­ä¿®æ”¹ç”¨æˆ·ç±»å‹
1. è®¿é—®ç”¨æˆ·è¯¦æƒ…é¡µé¢
2. é€‰æ‹©ç›®æ ‡ç”¨æˆ·ç±»å‹ï¼š
   - æ™®é€šç”¨æˆ·
   - å†…éƒ¨ç”¨æˆ·  
   - å®¢æœ
   - ç®¡ç†å‘˜
3. ä¿å­˜ä¿®æ”¹

### APIæ¥å£
```javascript
// æ›´æ–°ç”¨æˆ·ç±»å‹
PUT /api/admin/users/:id
{
  "isAdmin": false,
  "isInternal": false, 
  "isCustomerService": true  // è®¾ç½®ä¸ºå®¢æœ
}
```

## ğŸ“Š æ•°æ®åº“å­—æ®µè¯´æ˜

### usersè¡¨ç›¸å…³å­—æ®µ
```sql
ALTER TABLE users ADD COLUMN isCustomerService BOOLEAN NOT NULL DEFAULT FALSE COMMENT 'æ˜¯å¦ä¸ºå®¢æœäººå‘˜';
```

### å­—æ®µç»„åˆç¤ºä¾‹
| ç”¨æˆ·ç±»å‹ | isAdmin | isInternal | isCustomerService |
|---------|---------|------------|-------------------|
| æ™®é€šç”¨æˆ· | false   | false      | false             |
| å†…éƒ¨ç”¨æˆ· | false   | true       | false             |
| å®¢æœ     | false   | false      | true              |
| ç®¡ç†å‘˜   | true    | any        | any               |

## ğŸš€ ä¸šåŠ¡ä»·å€¼

### 1. èŒè´£åˆ†å·¥æ˜ç¡®
- å®¢æœä¸“æ³¨ç”¨æˆ·æœåŠ¡ï¼Œä¸æ¶‰åŠç³»ç»Ÿç®¡ç†
- ç®¡ç†å‘˜ä¸“æ³¨ç³»ç»Ÿè¿è¥ï¼Œå¯å…¼é¡¾å®¢æœå·¥ä½œ
- å†…éƒ¨ç”¨æˆ·æœ‰ç‰¹æ®Šæƒé™ï¼Œä¸å‚ä¸å®¢æœ

### 2. æƒé™æ§åˆ¶ç²¾ç»†
- æœ€å°æƒé™åŸåˆ™ï¼Œæ¯ç§ç”¨æˆ·åªæœ‰å¿…è¦çš„æƒé™
- å®‰å…¨æ€§æå‡ï¼Œé™ä½è¯¯æ“ä½œé£é™©
- ä¾¿äºæƒé™å®¡è®¡å’Œç®¡ç†

### 3. æ‰©å±•æ€§å¼º
- æ”¯æŒæœªæ¥æ·»åŠ æ›´å¤šç”¨æˆ·ç±»å‹
- æƒé™ç»„åˆçµæ´»ï¼Œå¯é€‚åº”ä¸šåŠ¡å˜åŒ–
- ä¾¿äºå®ç°æ›´å¤æ‚çš„æƒé™ä½“ç³»

### 4. ç®¡ç†ä¾¿æ·
- å¯å•ç‹¬ç®¡ç†å®¢æœå›¢é˜Ÿ
- æ¸…æ™°çš„ç”¨æˆ·åˆ†ç±»å’Œç»Ÿè®¡
- ä¾¿äºç»©æ•ˆè€ƒæ ¸å’Œå·¥ä½œåˆ†é…

## ğŸ“ æœ€ä½³å®è·µ

### 1. ç”¨æˆ·åˆ›å»ºå»ºè®®
- æ–°æ³¨å†Œç”¨æˆ·é»˜è®¤ä¸ºæ™®é€šç”¨æˆ·
- å®¢æœäººå‘˜ç”±ç®¡ç†å‘˜æ‰‹åŠ¨åˆ›å»ºæˆ–è½¬æ¢
- ç®¡ç†å‘˜æ•°é‡åº”è¯¥æ§åˆ¶åœ¨æœ€å°‘å¿…è¦æ•°é‡

### 2. æƒé™åˆ†é…åŸåˆ™
- éµå¾ªæœ€å°æƒé™åŸåˆ™
- å®šæœŸå®¡æŸ¥ç”¨æˆ·æƒé™
- åŠæ—¶å›æ”¶ç¦»èŒäººå‘˜æƒé™

### 3. å®‰å…¨æ³¨æ„äº‹é¡¹
- ç®¡ç†å‘˜è´¦å·ä½¿ç”¨å¼ºå¯†ç 
- å®¢æœè´¦å·å®šæœŸæ›´æ¢å¯†ç 
- ç›‘æ§å¼‚å¸¸ç™»å½•å’Œæ“ä½œ

---

**è¤ç«AIç”¨æˆ·ç±»å‹ä½“ç³»** - ä¸“ä¸šã€å®‰å…¨ã€é«˜æ•ˆçš„æƒé™ç®¡ç†æ–¹æ¡ˆï¼ 